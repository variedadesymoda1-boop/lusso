<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lusson | Catálogo Profesional</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <style>
        :root { --oro: #bca07d; --negro: #1a1a1a; --crema: #fdfaf7; }
        body { font-family: 'Montserrat', sans-serif; margin: 0; background: white; color: var(--negro); overflow-x: hidden; }

        /* HEADER COMPACTO */
        header { background: var(--crema); padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 100; }
        header h1 { font-family: 'Playfair Display', serif; font-size: 1.2rem; letter-spacing: 4px; margin: 0; }
        
        .cart-icon { position: relative; cursor: pointer; }
        .cart-badge { position: absolute; top: -8px; right: -8px; background: #ff4d4d; color: white; font-size: 0.6rem; padding: 2px 6px; border-radius: 50%; }

        nav { display: flex; justify-content: center; gap: 15px; padding: 10px; font-size: 0.65rem; font-weight: 600; letter-spacing: 2px; }
        nav a { text-decoration: none; color: var(--negro); }

        /* CATÁLOGO DE TAMAÑO REAL */
        .catalogo-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
            gap: 12px; padding: 15px; max-width: 1200px; margin: 0 auto; 
        }

        .card-producto { background: white; border: 1px solid #f0f0f0; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; }
        .card-producto img { width: 100%; height: 160px; object-fit: cover; background: #fafafa; }
        
        .info { padding: 8px; flex-grow: 1; }
        .info h3 { font-size: 0.65rem; margin: 5px 0; font-weight: 600; text-transform: uppercase; line-height: 1.2; height: 32px; overflow: hidden; }
        
        .footer-card { display: flex; justify-content: space-between; align-items: center; margin-top: auto; }
        .precio { color: var(--oro); font-weight: 600; font-size: 0.8rem; }
        
        .btn-add { background: var(--negro); color: white; border: none; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* CARRITO LATERAL */
        .cart-modal { position: fixed; top: 0; right: -100%; width: 100%; max-width: 320px; height: 100%; background: white; box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: 0.4s; z-index: 1000; display: flex; flex-direction: column; }
        .cart-modal.active { right: 0; }
        .cart-header { padding: 15px; background: var(--crema); display: flex; justify-content: space-between; border-bottom: 1px solid #eee; }
        .cart-content { flex: 1; overflow-y: auto; padding: 15px; font-size: 0.8rem; }
        .cart-item { display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #f9f9f9; }
        .btn-buy { background: #25d366; color: white; border: none; width: 100%; padding: 12px; border-radius: 5px; font-weight: 600; cursor: pointer; margin-top: 10px; }

        /* WHATSAPP FLOTANTE */
        .whatsapp-float { position: fixed; bottom: 20px; left: 20px; background: #25d366; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 900; }
        .whatsapp-float svg { color: white; width: 26px; }

        /* FOOTER Y LÍNEA SECRETA */
        footer { background: var(--negro); color: white; padding: 40px 20px; text-align: center; }
        .linea-decorativa { 
            width: 60px; height: 2px; background: var(--oro); 
            margin: 20px auto; cursor: pointer; border: none;
            transition: 0.3s;
        }
        .linea-decorativa:active { transform: scaleX(1.5); background: white; }

        @media (max-width: 600px) { .catalogo-grid { grid-template-columns: 1fr 1fr; } }
    </style>
</head>
<body>

    <header>
        <div style="width: 24px;"></div>
        <h1>LUSSON</h1>
        <div class="cart-icon" onclick="toggleCart()">
            <i data-feather="shopping-bag"></i>
            <span class="cart-badge" id="cart-count">0</span>
        </div>
    </header>

    <nav>
        <a href="index.html">INICIO</a>
        <a href="bases.html">BASES</a>
        <a href="labiales.html" style="color: var(--oro);">LABIALES</a>
    </nav>

    <main class="catalogo-grid" id="lista-labiales">
        <p style="grid-column: 1/-1; text-align: center; padding: 50px; color: #888;">Sincronizando productos reales...</p>
    </main>

    <div class="cart-modal" id="cart-modal">
        <div class="cart-header">
            <span style="font-weight:600;">CARRITO</span>
            <button onclick="toggleCart()" style="background:none; border:none; cursor:pointer;"><i data-feather="x"></i></button>
        </div>
        <div class="cart-content" id="cart-items"></div>
        <div class="cart-footer" style="padding:15px; border-top:1px solid #eee;">
            <div style="display:flex; justify-content:space-between; margin-bottom:15px; font-weight:600;">
                <span>TOTAL:</span><span id="cart-total">$ 0</span>
            </div>
            <button class="btn-buy" onclick="enviarPedido()">PEDIR POR WHATSAPP</button>
        </div>
    </div>

    <a href="https://wa.me/573153564016" class="whatsapp-float"><i data-feather="message-circle"></i></a>

    <footer>
        <h2 style="font-family:'Playfair Display'; letter-spacing:4px; font-size:1rem; margin:0;">LUSSON</h2>
        <hr class="linea-decorativa" onclick="modoJefa()">
        <p style="font-size: 0.5rem; letter-spacing: 2px; color: var(--oro); margin: 0;">COSMÉTICA DE ALTA GAMA</p>
        <p style="font-size: 0.45rem; color: #444; margin-top: 20px;">© 2026 LUSSON COLOMBIA - DERECHOS RESERVADOS</p>
    </footer>

    <script>
        feather.replace();
        let carrito = [];

        // --- LECTOR REAL DE PRODUCTOS ---
        async function cargarCatalogo() {
            const grid = document.getElementById('lista-labiales');
            const repo = "variedadesymoda1-boop/lusso";
            
            try {
                const response = await fetch(`https://api.github.com/repos/${repo}/contents/_labiales`);
                const archivos = await response.json();
                
                if (archivos.length > 0) grid.innerHTML = '';

                for (let file of archivos) {
                    const contentRes = await fetch(file.download_url);
                    const text = await contentRes.text();
                    // Lee el archivo que crea el panel (formato YAML)
                    const data = jsyaml.load(text.split('---')[1]);
                    
                    grid.innerHTML += `
                        <div class="card-producto">
                            <img src="${data.image}" onerror="this.src='https://via.placeholder.com/150?text=Lusson'">
                            <div class="info">
                                <h3>${data.title}</h3>
                                <div class="footer-card">
                                    <span class="precio">$ ${Number(data.precio).toLocaleString('es-CO')}</span>
                                    <button class="btn-add" onclick="agregarAlCarrito('${data.title}', ${data.precio})"><i data-feather="plus" style="width:14px;"></i></button>
                                </div>
                            </div>
                        </div>
                    `;
                }
                feather.replace();
            } catch (e) {
                grid.innerHTML = '<p style="grid-column:1/-1; text-align:center;">Agrega productos en el panel para verlos aquí.</p>';
            }
        }

        // --- FUNCIONES DEL CARRITO ---
        function toggleCart() { document.getElementById('cart-modal').classList.toggle('active'); }
        
        function agregarAlCarrito(nombre, precio) {
            carrito.push({nombre, precio});
            actualizarCarrito();
            if(!document.getElementById('cart-modal').classList.contains('active')) toggleCart();
        }

        function actualizarCarrito() {
            const container = document.getElementById('cart-items');
            let total = 0;
            container.innerHTML = '';
            carrito.forEach((item, i) => {
                total += Number(item.precio);
                container.innerHTML += `
                    <div class="cart-item">
                        <div><b>${item.nombre}</b><br>$ ${Number(item.precio).toLocaleString('es-CO')}</div>
                        <i data-feather="trash-2" onclick="carrito.splice(${i},1);actualizarCarrito()" style="width:14px; cursor:pointer; color:red;"></i>
                    </div>`;
            });
            document.getElementById('cart-count').innerText = carrito.length;
            document.getElementById('cart-total').innerText = `$ ${total.toLocaleString('es-CO')}`;
            feather.replace();
        }

        function enviarPedido() {
            if(carrito.length === 0) return;
            let msg = "¡Hola Lusson! ✨ Quisiera pedir:\n" + carrito.map(i => `- ${i.nombre}`).join('\n') + `\n\n*Total: ${document.getElementById('cart-total').innerText}*`;
            window.open(`https://wa.me/573153564016?text=${encodeURIComponent(msg)}`);
        }

        // --- MODO JEFA (LÍNEA DORADA) ---
        let toques = 0;
        function modoJefa() {
            toques++;
            if (toques === 5) {
                toques = 0;
                window.location.href = "admin/index.html";
            }
            setTimeout(() => { toques = 0; }, 3000);
        }

        cargarCatalogo();
    </script>
</body>
</html>
