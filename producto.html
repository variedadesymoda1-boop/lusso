<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalle de Producto | LUSSON</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --pink-cute: #ffdeeb; --pink-accent: #f8bbd0; --negro: #1a1a1a; --blanco: #ffffff; --oro: #bca07d; }
        body { margin: 0; font-family: 'Montserrat', sans-serif; background: var(--blanco); color: var(--negro); }
        
        /* NAVBAR ESTILO LUSSON */
        .nav-franja { background: var(--pink-cute); padding: 10px 0; position: sticky; top: 0; z-index: 1000; }
        .nav-container { display: flex; justify-content: space-between; align-items: center; max-width: 1100px; margin: auto; padding: 0 20px; }
        .logo { font-family: 'Playfair Display', serif; font-size: 1.5rem; letter-spacing: 5px; text-decoration: none; color: var(--negro); }
        .cart-icon { position: relative; cursor: pointer; font-size: 1.2rem; }
        #cart-count { position: absolute; top: -10px; right: -10px; background: var(--pink-accent); color: white; font-size: 10px; padding: 2px 6px; border-radius: 50%; font-weight: bold; }

        .contenedor-detalle { max-width: 1100px; margin: 40px auto; padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px; }
        .visor-principal { width: 100%; height: 450px; border-radius: 8px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .visor-principal img { width: 100%; height: 100%; object-fit: cover; }
        
        .info-producto { display: flex; flex-direction: column; gap: 15px; }
        .nombre-p { font-family: 'Playfair Display', serif; font-size: 2.5rem; margin: 0; }
        .precio-p { font-size: 1.8rem; font-weight: 600; color: var(--pink-accent); }
        
        .titulo-seccion { font-weight: 600; font-size: 0.75rem; letter-spacing: 2px; text-transform: uppercase; color: var(--oro); margin-top: 20px; display: block; }
        .texto-contenido { line-height: 1.6; color: #555; font-size: 0.9rem; margin-bottom: 10px; white-space: pre-line; }

        .btn-comprar { background: #25d366; color: white; border: none; padding: 18px; text-transform: uppercase; letter-spacing: 3px; cursor: pointer; font-weight: 600; width: 100%; border-radius: 5px; margin-top: 15px; }
        
        /* CARRITO LATERAL */
        .cart-panel { position: fixed; top: 0; right: -400px; width: 320px; height: 100%; background: white; z-index: 2001; transition: 0.4s; padding: 25px; box-shadow: -5px 0 15px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .cart-panel.active { right: 0; }
        .cart-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.2); z-index: 2000; display: none; }
        .cart-overlay.active { display: block; }
    </style>
</head>
<body>

    <div class="nav-franja">
        <div class="nav-container">
            <a href="index.html" class="logo">LUSSON</a>
            <div class="cart-icon" onclick="toggleCart(true)">
                <i class="fa-solid fa-bag-shopping"></i>
                <span id="cart-count">0</span>
            </div>
        </div>
    </div>

    <div class="contenedor-detalle">
        <div class="seccion-imagenes">
            <div class="visor-principal">
                <img id="img-grande" src="" alt="Producto">
            </div>
        </div>
        
        <div class="info-producto">
            <h1 id="nombre-producto" class="nombre-p">Cargando...</h1>
            <p id="precio-producto" class="precio-p">$0</p>
            
            <div class="seccion-texto">
                <span class="titulo-seccion">Descripción</span>
                <p id="desc-producto" class="texto-contenido">...</p>
                
                <span class="titulo-seccion">Especificaciones Técnicas</span>
                <p id="specs-producto" class="texto-contenido">...</p>
            </div>
            
            <button class="btn-comprar" onclick="agregarAlCarrito()">Agregar a la bolsa</button>
        </div>
    </div>

    <div class="cart-overlay" id="cartOverlay" onclick="toggleCart(false)"></div>
    <div class="cart-panel" id="cartPanel">
        <h3>MI BOLSA</h3>
        <div id="cart-items" style="flex-grow:1; overflow-y:auto;"></div>
        <div style="border-top:1px solid #eee; padding-top:15px;">
            <strong>TOTAL: $<span id="total-price">0</span></strong>
            <button onclick="enviarWhatsApp()" style="width:100%; background:#25d366; color:white; border:none; padding:12px; margin-top:10px; border-radius:5px; cursor:pointer;">FINALIZAR POR WHATSAPP</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        const firebaseConfig = { /* TU CONFIGURACIÓN AQUÍ */ };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const params = new URLSearchParams(window.location.search);
        const prodId = params.get('id');
        const col = params.get('col'); // Ej: 'labiales'
        let productoActual = null;
        let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

        // BUSCAR DATOS EN FIREBASE
        if(prodId && col) {
            db.collection(col).doc(prodId).get().then((doc) => {
                if(doc.exists) {
                    productoActual = doc.data();
                    document.getElementById('nombre-producto').innerText = productoActual.nombre;
                    document.getElementById('precio-producto').innerText = '$' + productoActual.precio.toLocaleString();
                    document.getElementById('img-grande').src = productoActual.img;
                    document.getElementById('desc-producto').innerText = productoActual.descripcion || "Sin descripción";
                    document.getElementById('specs-producto').innerText = productoActual.specs || "Sin especificaciones";
                }
            });
        }

        function toggleCart(show) {
            document.getElementById('cartPanel').classList.toggle('active', show);
            document.getElementById('cartOverlay').classList.toggle('active', show);
        }

        function agregarAlCarrito() {
            const index = carrito.findIndex(item => item.nombre === productoActual.nombre);
            if(index > -1) carrito[index].cantidad++;
            else carrito.push({ ...productoActual, cantidad: 1 });
            
            localStorage.setItem('carrito', JSON.stringify(carrito));
            actualizarCarritoUI();
            toggleCart(true);
        }

        function actualizarCarritoUI() {
            const container = document.getElementById('cart-items');
            container.innerHTML = '';
            let total = 0;
            carrito.forEach((item, idx) => {
                total += item.precio * item.cantidad;
                container.innerHTML += `<div style="margin-bottom:10px; font-size:12px;">
                    ${item.nombre} x${item.cantidad} - $${(item.precio * item.cantidad).toLocaleString()}
                </div>`;
            });
            document.getElementById('total-price').innerText = total.toLocaleString();
            document.getElementById('cart-count').innerText = carrito.length;
        }

        function enviarWhatsApp() {
            let msg = "¡Hola LUSSON! Mi pedido es:\n";
            carrito.forEach(i => msg += `- ${i.nombre} x${i.cantidad}\n`);
            window.open(`https://wa.me/570000000000?text=${encodeURIComponent(msg)}`);
        }
        
        actualizarCarritoUI();
    </script>
</body>
</html>

